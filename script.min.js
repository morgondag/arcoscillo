function init(){setCanvas(),createOscillator(),getUserMedia()}function setCanvas(){var a=document.getElementById("canvas");a.height=height,a.width=width,canvasContext=a.getContext("2d")}function createOscillator(){oscillatorContext=new webkitAudioContext,oscillator=oscillatorContext.createOscillator(),oscillator.connect(oscillatorContext.destination),cacheWaveType&&(oscillator.type=cacheWaveType),oscillator.frequency.value=0,oscillator.start(0),isOscillatorOn=!0}function getUserMedia(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({audio:!0},createMediaStreamSource)}function createMediaStreamSource(a){isAllowed=!0,window.AudioContext=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext,audioContext=new AudioContext,mediaStreamSource=audioContext.createMediaStreamSource(a),meter=createAudioMeter(audioContext),mediaStreamSource.connect(meter),animate()}function animate(){requestAnimFrame(animate),volume=Math.floor(1e3*meter.volume);var a=getColor();canvasContext.clearRect(0,0,width,height),canvasContext.beginPath(),canvasContext.arc(width/2,height/2,volume,0,2*Math.PI,!0),canvasContext.closePath(),canvasContext.fillStyle=a,canvasContext.fill(),updateOscillatorFreq()}function updateOscillatorFreq(){oscillator.frequency.value=volume>=100?2*volume:100}function getColor(){return volume>100&&250>=volume?"#0F9D58":volume>250&&350>=volume?"#F4B400":volume>350?"#DB4437":"#4285F8"}function toggleActiveClass(a,b){if(b){var c=document.querySelectorAll(".wave-type.active");c[0].classList.toggle("active")}if(a.classList)a.classList.toggle("active");else{var d=a.className.split(" "),e=d.indexOf("active");e>=0?d.splice(e,1):d.push("active"),a.className=d.join(" ")}}function changeWaveType(a){"undefined"!=typeof oscillator&&(toggleActiveClass(a.target,!0),cacheWaveType=JSON.parse(a.target.value),oscillator.type=cacheWaveType)}function toggleMediaSource(a){toggleActiveClass(a.target,!1),isOscillatorOn?(oscillator.stop(0),mediaStreamSource.disconnect(),isOscillatorOn=!1):isAllowed?(createOscillator(),mediaStreamSource.connect(meter),isOscillatorOn=!0):init()}var audioContext,canvasContext,mediaStreamSource,meter,oscillator,oscillatorContext,volume,cacheWaveType,isOscillatorOn=!1,isAllowed=!1,body=document.body,html=document.documentElement,height=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight),width=Math.max(body.scrollWidth,body.offsetWidth,html.clientWidth,html.scrollWidth,html.offsetWidth);window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}();